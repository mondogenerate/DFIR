let CompromisedDevice = "blueiris-forbes";
let SearchWindow = 48h; //Customizable h = hours, d = days
let ExploitGuardEvents = DeviceEvents
     | where Timestamp > ago(SearchWindow)
    // | where DeviceName == CompromisedDevice
     | where ActionType startswith "ExploitGuard"
     | project Timestamp, DeviceName, ActionType, FileName, FolderPath, RemoteUrl;
// List all amsi events
let AMSIEvents = DeviceEvents
     | where Timestamp > ago(SearchWindow)
    //  | where DeviceName == CompromisedDevice
     | where ActionType contains "Amsi"
     | extend Description = tostring(parse_json(AdditionalFields).Description)
     | project Timestamp, DeviceName, ActionType, Description, FolderPath;
// Combine all results into one output
(union isfuzzy=true
     (ExploitGuardEvents),
     (AMSIEvents)
     | sort by Timestamp
)